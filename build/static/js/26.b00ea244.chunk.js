(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[26],{501:function(e,t,a){var n=a(214);e.exports=function(e,t){return n(e,t)}},560:function(e,t,a){"use strict";var n=a(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"},s=a(12),c=function(e,t){return n.createElement(s.a,Object.assign({},e,{ref:t,icon:r}))};c.displayName="DollarOutlined";t.a=n.forwardRef(c)},691:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(471),s=a(289),c=a(512),i=a(511),o=a(109),l=a(474),d=a(703),u=a(708),m=a(93),j=a(560),p=a(182),b=a(218),y=a(219),v=a(212),h=a(1);const{Text:x}=r.a;t.default=()=>{var e,t,a;const[r,O]=Object(n.useState)([]),[g,f]=Object(n.useState)(!0),[_,C]=Object(n.useState)(!1),[w,P]=Object(n.useState)(null),[k,S]=Object(n.useState)(""),[A,D]=Object(n.useState)(""),[L,N]=Object(n.useState)(""),E=async()=>{f(!0);try{const e=await v.a.get("Contracts",{tabFilter:{status:"Completed",payment_status:{$ne:"Paid"}}});e.data&&e.data.data&&O(e.data.data)}catch(e){s.b.error("Failed to fetch contracts"),console.error("Error fetching contracts:",e)}finally{f(!1)}};Object(n.useEffect)((()=>{E()}),[]);const I=r.filter((e=>{var t,a,n,r,s,c;return""===A||(null===(t=e.campaign)||void 0===t||null===(a=t.campaign_name)||void 0===a?void 0:a.toLowerCase().includes(A.toLowerCase()))||(null===(n=e.user)||void 0===n||null===(r=n.name)||void 0===r?void 0:r.toLowerCase().includes(A.toLowerCase()))||(null===(s=e.user)||void 0===s||null===(c=s.email)||void 0===c?void 0:c.toLowerCase().includes(A.toLowerCase()))})),z=[{title:"Contract ID",dataIndex:"_id",key:"_id",render:e=>Object(h.jsxs)(x,{copyable:!0,children:[e.substring(0,8),"..."]})},{title:"Campaign",dataIndex:"campaign",key:"campaign",render:e=>(null===e||void 0===e?void 0:e.campaign_name)||"N/A"},{title:"Creator",key:"creator",render:(e,t)=>{var a,n;return Object(h.jsxs)("span",{children:[(null===(a=t.user)||void 0===a?void 0:a.name)||"Unknown",Object(h.jsx)("br",{}),Object(h.jsx)("small",{children:(null===(n=t.user)||void 0===n?void 0:n.email)||""})]})}},{title:"Amount",dataIndex:"amount",key:"amount",render:e=>"$".concat(e.toFixed(2))},{title:"Completion Date",key:"completionDate",render:(e,t)=>{var a,n;const r=null===(a=t.timeline)||void 0===a?void 0:a.find((e=>{var t;return"project_completed"===e.type||"Completed"===(null===(t=e.data)||void 0===t?void 0:t.status)}));return(s=(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.date)||t.updatedAt)?new Date(s).toLocaleDateString():"N/A";var s}},{title:"Payment Status",key:"payment_status",render:(e,t)=>Object(h.jsx)(c.a,{color:"Paid"===t.payment_status?"green":"volcano",children:t.payment_status||"Pending"})},{title:"Action",key:"action",render:(e,t)=>Object(h.jsx)(i.b,{size:"middle",children:Object(h.jsx)(o.a,{type:"primary",icon:Object(h.jsx)(j.a,{}),onClick:()=>(P(t),S(""),N(""),void C(!0)),disabled:"Paid"===t.payment_status,children:"Process Payment"})})}];return Object(h.jsxs)("div",{className:"admin-contracts",children:[Object(h.jsx)("h2",{children:"Contract Payment Management"}),Object(h.jsx)("div",{style:{marginBottom:16},children:Object(h.jsx)(l.a,{placeholder:"Search campaigns or creators",prefix:Object(h.jsx)(p.a,{}),value:A,onChange:e=>D(e.target.value),style:{width:300}})}),Object(h.jsx)(d.a,{columns:z,dataSource:I,rowKey:"_id",loading:g}),Object(h.jsx)(u.a,{title:"Process Payment",visible:_,onCancel:()=>C(!1),onOk:async()=>{try{if(!w)return;const e={contract_id:w._id,payment_reference_id:L,payment_notes:k,amount:w.amount,status:"Completed",description:"Payment for contract #".concat(w._id),user_id:w.user_id},t=await v.a.save("Payments",e);if(t.success){(await v.a.update("Contracts",{_id:w._id,payment_status:"Paid",payment_id:t.data._id,payment_date:new Date,payment_notes:k,payment_reference_id:L},w._id)).success?(s.b.success("Payment marked as processed successfully"),C(!1),E()):s.b.error("Failed to update contract payment status")}else s.b.error("Failed to create payment record")}catch(e){s.b.error("An error occurred while processing payment"),console.error("Error processing payment:",e)}},okText:"Confirm Payment",okButtonProps:{icon:Object(h.jsx)(b.a,{}),disabled:!L.trim()},children:w&&Object(h.jsxs)("div",{children:[Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Campaign:"})," ",(null===(e=w.campaign)||void 0===e?void 0:e.campaign_name)||"N/A"]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Creator:"})," ",(null===(t=w.user)||void 0===t?void 0:t.name)||"Unknown"]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Email:"})," ",(null===(a=w.user)||void 0===a?void 0:a.email)||"N/A"]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Amount to Pay:"})," $",w.amount.toFixed(2)]}),Object(h.jsxs)("div",{style:{marginTop:20},children:[Object(h.jsxs)("div",{style:{marginBottom:16},children:[Object(h.jsxs)("label",{style:{display:"block",marginBottom:8},children:["Payment Reference ID:",Object(h.jsx)(m.a,{title:"Enter the transaction ID from your payment system",children:Object(h.jsx)(y.a,{style:{marginLeft:8}})})]}),Object(h.jsx)(l.a,{placeholder:"Transaction ID / Reference Number",value:L,onChange:e=>N(e.target.value),required:!0})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{style:{display:"block",marginBottom:8},children:"Payment Notes (optional):"}),Object(h.jsx)(l.a.TextArea,{rows:4,placeholder:"Enter any additional payment details",value:k,onChange:e=>S(e.target.value)})]})]})]})})]})}}}]);
//# sourceMappingURL=26.b00ea244.chunk.js.map