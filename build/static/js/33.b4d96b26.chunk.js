(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[33],{713:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(44),i=a(471),l=a(289),r=a(708),n=a(473),d=a(512),o=a(109),j=a(476),b=a(236),p=a(124),m=a(717),u=a(718),h=a(719),x=a(84),O=a(265),y=a(513),g=a(211),v=a(511),f=a(703),w=a(212),N=a(531),_=a(686),C=a(577),k=a(1);const S=Object(_.a)("pk_test_51QbWrHFfFMx3GxeO6G8C72ke4dJCj5x80YazKFT2onSW58h1j0MtrlHK0stjeW0ioejX1MRfpprS621z2m7DLMfh009uRSSWCH"),F=e=>{let{amount:t,onSuccess:a,onCancel:c}=e;const i=Object(C.useStripe)(),l=Object(C.useElements)(),[r,n]=Object(s.useState)(!1),[d,j]=Object(s.useState)(null);return Object(k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n(!0),j(null),i&&l)try{const e=await w.a.customRoute("createPaymentIntent",{amount:t}),{clientSecret:s}=e,c=await i.confirmCardPayment(s,{payment_method:{card:l.getElement(C.CardElement)}});c.error?j(c.error.message):a(c.paymentIntent)}catch(s){j("Payment failed. Please try again.")}finally{n(!1)}},style:{margin:"0 auto"},children:[d&&Object(k.jsx)(N.a,{message:"Payment Error",description:d,type:"error",style:{marginBottom:"16px"}}),Object(k.jsx)("div",{style:{padding:"16px",border:"1px solid #d9d9d9",borderRadius:"6px",marginBottom:"16px"},children:Object(k.jsx)(C.CardElement,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})}),Object(k.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[Object(k.jsx)(o.a,{onClick:c,disabled:r,children:"Cancel"}),Object(k.jsx)(o.a,{type:"primary",htmlType:"submit",loading:r,disabled:!i,className:"primary-solid-button",children:r?"Processing...":"Pay $".concat(t)})]})]})};var A=e=>{let{visible:t,amount:a,onSuccess:s,onCancel:c}=e;return Object(k.jsx)(r.a,{title:"Complete Payment",visible:t,onCancel:c,footer:null,width:600,centered:!0,children:Object(k.jsx)(C.Elements,{stripe:S,children:Object(k.jsx)(F,{amount:a,onSuccess:s,onCancel:c})})})};const{Title:P,Text:H}=i.a,{TabPane:D}=g.a;t.default=()=>{const{id:e}=Object(c.useParams)(),t=Object(c.useHistory)(),[a,i]=Object(s.useState)({}),[N,_]=Object(s.useState)([]),[C,S]=Object(s.useState)([]),[F,R]=Object(s.useState)(Math.random()),[U,I]=Object(s.useState)(!1),[z,E]=Object(s.useState)(null),[L,M]=Object(s.useState)(!0),T=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},{confirm:B}=r.a,K=()=>{var e,t,a,c;const[i,r]=Object(s.useState)(!1),[b,p]=Object(s.useState)(null),[O,_]=Object(s.useState)("all"),C=[{title:"Name",dataIndex:"name",width:"20%",key:"name",render:(e,t)=>{var a,s,c;return Object(k.jsxs)("div",{className:"name-container",children:[Object(k.jsx)(n.a,{src:null===(a=t.created_by)||void 0===a?void 0:a.profile_picture,className:"avatar-style",children:(null===(s=t.created_by)||void 0===s?void 0:s.name)?t.created_by.name.charAt(0).toUpperCase():"U"}),Object(k.jsx)("div",{className:"name-details",children:Object(k.jsx)("div",{className:"name-text",children:(null===(c=t.created_by)||void 0===c?void 0:c.name)||"Unknown User"})})]})}},{title:"Quote",dataIndex:"amount",width:"10%",key:"amount",render:e=>Object(k.jsxs)("span",{children:["$ ",e]})},{title:"Details",dataIndex:"cover_letter",width:"28%",key:"cover_letter",render:e=>Object(k.jsx)("span",{children:e?e.length>50?e.substring(0,50)+"...":e:"No details provided"})},{title:"Criteria",key:"criterias",dataIndex:"criterias",width:"35%",render:e=>Object(k.jsx)("div",{className:"criteria-container",children:(e||[]).map((e=>Object(k.jsx)(d.a,{className:"criteria-tag",children:e},e)))})},{title:"Status",key:"status",width:"10%",dataIndex:"status",render:e=>{let t="status-default";return"Hired"===e&&(t="status-hired"),"Shortlisted"===e&&(t="status-shortlisted"),"Rejected"===e&&(t="status-rejected"),"Applied"===e&&(t="status-applied"),Object(k.jsx)("span",{className:"status-badge ".concat(t),children:e})}},{title:"",key:"action",width:"17%",render:e=>Object(k.jsxs)(v.b,{size:"middle",className:"action-container",children:["Hired"!==e.status&&Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(o.a,{type:"text",icon:"Shortlisted"===e.status?Object(k.jsx)(m.a,{style:{color:"#16a34a"}}):Object(k.jsx)(u.a,{}),onClick:()=>F(e._id)})}),Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(o.a,{type:"text",icon:Object(k.jsx)(h.a,{}),onClick:()=>(p(e),void r(!0)),style:{cursor:"pointer"}})}),"Hired"!==e.status&&Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(o.a,{type:"text",icon:Object(k.jsx)(x.a,{style:{color:"red"}}),onClick:()=>S(e._id)})})]})}],S=async e=>{try{const t=await w.a.update("Applications",{status:"Rejected"},e);t.success?(l.b.success("Application rejected successfully"),R(Math.random())):l.b.error(t.message||"Failed to reject application")}catch(t){console.error("Application reject error:",t),l.b.error("Failed to reject application")}},F=async e=>{try{const t=await w.a.update("Applications",{status:"Shortlisted"},e);t.success?(l.b.success("Application shortlisted successfully"),R(Math.random())):l.b.error(t.message||"Failed to shortlist application")}catch(t){console.error("Application shortlist error:",t),l.b.error("Failed to shortlist application")}},A=()=>Object(k.jsx)(f.a,{columns:C,dataSource:N.filter((e=>"all"===O||e.status.toLowerCase()===O.toLowerCase())),rowKey:"_id",pagination:N.length>10&&{pageSize:10,showSizeChanger:!0,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," applications")},loading:L}),P=[{key:"all",label:Object(k.jsxs)(k.Fragment,{children:["All",Object(k.jsx)("span",{className:"ml-2 status-badge status-default",children:N.length})]})},{key:"applied",label:Object(k.jsxs)(k.Fragment,{children:["Applied",Object(k.jsx)("span",{className:"ml-2 status-badge status-applied",children:N.filter((e=>"Applied"===e.status)).length})]})},{key:"shortlisted",label:Object(k.jsxs)(k.Fragment,{children:["Shortlisted",Object(k.jsx)("span",{className:"ml-2 text-blue-600 status-badge status-shortlisted",children:N.filter((e=>"Shortlisted"===e.status)).length})]})},{key:"hired",label:Object(k.jsxs)(k.Fragment,{children:["Hired",Object(k.jsx)("span",{className:"ml-2 text-green-600 status-badge status-hired",children:N.filter((e=>"Hired"===e.status)).length})]})},{key:"rejected",label:Object(k.jsxs)(k.Fragment,{children:["Rejected",Object(k.jsx)("span",{className:"ml-2 text-red-600 status-badge status-rejected",children:N.filter((e=>"Rejected"===e.status)).length})]})}];return Object(k.jsxs)("div",{className:"p-4 campaign-detail-tables",children:[Object(k.jsx)(j.a,{title:null,placement:"right",onClose:()=>{r(!1),p(null)},visible:i,width:450,className:"custom-drawer",children:b&&Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{className:"status-badge status-".concat(b.status.toLowerCase()),style:{display:"inline-block",marginBottom:"16px"},children:b.status}),Object(k.jsxs)("div",{className:"name-container mt-4 mb-3",children:[Object(k.jsx)(n.a,{src:null===(e=b.created_by)||void 0===e?void 0:e.profile_picture,className:"avatar-style",children:Object(k.jsx)("span",{className:"avatar-text",children:(null===(t=b.created_by)||void 0===t?void 0:t.name)?b.created_by.name.charAt(0).toUpperCase():"U"})}),Object(k.jsx)("div",{className:"name-details",children:Object(k.jsx)("div",{className:"name-text",children:(null===(a=b.created_by)||void 0===a?void 0:a.name)||"Unknown User"})})]}),Object(k.jsxs)("div",{className:"mb-3",style:{display:"flex",gap:"10px"},children:[Object(k.jsx)("div",{style:{width:"20%"},children:"Quote:"}),Object(k.jsxs)("div",{style:{width:"80%"},children:["$ ",b.amount]})]}),Object(k.jsxs)("div",{className:"mb-3",style:{display:"flex",gap:"10px"},children:[Object(k.jsx)("div",{style:{width:"20%"},children:"Proposed Deadline:"}),Object(k.jsx)("div",{style:{width:"80%"},children:b.deadline_date?T(b.deadline_date):"Not specified"})]}),Object(k.jsxs)("div",{className:"mb-3",style:{display:"flex",gap:"10px"},children:[Object(k.jsx)("div",{style:{width:"20%"},children:"Criteria:"}),Object(k.jsx)("div",{style:{width:"80%"},children:Object(k.jsx)("div",{className:"criteria-container",children:(b.criterias||[]).map((e=>Object(k.jsx)(d.a,{className:"criteria-tag",children:e},e)))})})]}),Object(k.jsxs)("div",{className:"mb-3",style:{display:"flex",gap:"10px"},children:[Object(k.jsx)("div",{style:{width:"20%"},children:"Details:"}),Object(k.jsx)("div",{style:{width:"80%"},children:Object(k.jsx)("p",{style:{border:"1px solid #f0f0f0",padding:"8px",borderRadius:"4px",background:"#fafafa",maxHeight:"200px",overflowY:"auto"},children:b.cover_letter||"No additional details provided"})})]}),Object(k.jsxs)("div",{className:"mb-3",style:{display:"flex",gap:"10px"},children:[Object(k.jsx)("div",{style:{width:"20%"},children:"Portfolio:"}),Object(k.jsx)("div",{style:{width:"80%"},children:Object(k.jsx)(y.Link,{to:"/app/brands/portfolio/"+(null===(c=b.created_by)||void 0===c?void 0:c._id),target:"_blank",rel:"noopener noreferrer",className:"portfolio-link",children:"View Profile \u2197"})})]}),"Hired"!==b.status&&Object(k.jsxs)("div",{style:{marginTop:"24px",display:"flex",gap:"12px"},children:[Object(k.jsx)(o.a,{type:"primary",style:{background:"#f97316",border:"none"},onClick:()=>{E(b),I(!0)},children:"Hire"}),Object(k.jsx)(o.a,{type:"default",style:{background:"#e0f2fe",color:"#0284c7"},onClick:()=>F(b._id),children:"Shortlist"}),Object(k.jsx)(o.a,{type:"default",style:{background:"#fee2e2",color:"#b91c1c"},onClick:()=>S(b._id),children:"Reject"})]})]})}),Object(k.jsx)(g.a,{defaultActiveKey:"all",onChange:e=>{_(e)},children:P.map((e=>Object(k.jsx)(D,{tab:e.label,children:Object(k.jsx)(A,{})},e.key)))})]})};return Object(s.useEffect)((()=>{e?(async()=>{try{M(!0);const t=await w.a.getSingle("Campaigns",{_id:e}),a=await w.a.get("Contracts",{tabFilter:{campaign_id:e}}),s=await w.a.get("Applications",{tabFilter:{campaign_id:e}});t&&t.data&&i(t.data),a&&a.data&&S(a.data.data||[]),s&&s.data&&_(s.data.data||[])}catch(t){console.error("Error fetching campaign details:",t),l.b.error("Failed to load campaign data")}finally{M(!1)}})():t.goBack()}),[e,F]),L&&!a._id?Object(k.jsx)("div",{className:"loading-container",children:Object(k.jsx)(b.a,{size:"large"})}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"campaign-container",children:[Object(k.jsxs)("div",{className:"campaign-header",children:[Object(k.jsx)(P,{level:2,children:a.campaign_name||"Campaign Details"}),Object(k.jsx)(y.Link,{to:"campaign-info/".concat(e),children:Object(k.jsxs)(o.a,{className:"secondary-color-btn",children:[Object(k.jsx)("span",{children:"View Campaign Info"})," ",Object(k.jsx)(O.a,{})]})})]}),Object(k.jsxs)(H,{className:"breadcrumb",children:["Campaigns",Object(k.jsx)("span",{className:"mx-2",children:"\u2022"})," All Campaigns",Object(k.jsx)("span",{className:"mx-2",children:"\u2022"}),Object(k.jsx)("span",{className:"prm-color",children:a.campaign_name||"Campaign Details"})]}),Object(k.jsx)(p.a,{gutter:[24,24],className:"project-grid",children:C.length>0?C.map((e=>{var t,a,s;return Object(k.jsxs)("div",{className:"project-card",style:{display:"flex"},children:[Object(k.jsx)("div",{style:{width:"23%",display:"flex",justifyContent:"space-between"},children:Object(k.jsx)(n.a,{src:null===(t=e.user)||void 0===t?void 0:t.profile_picture,size:50,style:{backgroundColor:"#f56a00"},children:(null===(a=e.user)||void 0===a?void 0:a.name)?e.user.name.charAt(0).toUpperCase():"U"})}),Object(k.jsxs)("div",{style:{width:"77%"},children:[Object(k.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(k.jsx)("span",{children:Object(k.jsx)(d.a,{color:"green",className:"status-tag",children:e.status||"Hired"})}),Object(k.jsx)("span",{children:Object(k.jsxs)(H,{className:"price",children:["$",e.amount]})})]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(H,{className:"name mt-2 mb-2",children:(null===(s=e.user)||void 0===s?void 0:s.name)||"Creator"}),Object(k.jsxs)(H,{className:"deadline d-block mb-2",children:["Deadline: ",e.end_date?T(e.end_date):"Not specified"]}),Object(k.jsx)(y.Link,{to:"view-project/"+e._id,className:"view-project-btn",children:"View Project"})]})]})]},e._id)})):Object(k.jsx)("div",{className:"no-contracts-message",children:"No creators hired yet. Review applications below to hire creators."})})]}),Object(k.jsx)(K,{}),Object(k.jsx)(A,{visible:U,amount:(null===z||void 0===z?void 0:z.amount)||0,onSuccess:async t=>{try{if(!z)return;const a=await w.a.update("Applications",{status:"Hired",payment_intent_id:t.id},z._id);a.success?(await w.a.save("Contracts",{campaign_id:e,application_id:z._id,user_id:z.user_id,start_date:new Date,end_date:new Date(z.deadline_date),amount:z.amount,status:"In Progress",payment_intent_id:t.id,timeline:[{type:"contract_started",data:{brand_text:"You started the contract",creator_text:"Brand started the contract",date:new Date,amount:z.amount}}]}),l.b.success("Payment completed and creator hired successfully!"),R(Math.random())):l.b.error(a.message||"Failed to update application")}catch(a){console.error("Contract creation error:",a),l.b.error("Failed to create contract. Please try again.")}finally{I(!1),E(null)}},onCancel:()=>{I(!1),E(null)}})]})}}}]);
//# sourceMappingURL=33.b4d96b26.chunk.js.map